(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/team/my-team-detail"],{5190:function(t,e,a){"use strict";a.r(e);var n=a("62d3"),i=a.n(n);for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"62d3":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a("a34a")),i=a("2f62");function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e,a,n,i,s,o){try{var r=t[s](o),c=r.value}catch(u){return void a(u)}r.done?e(c):Promise.resolve(c).then(n,i)}function r(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var s=t.apply(e,a);function r(t){o(s,n,i,r,c,"next",t)}function c(t){o(s,n,i,r,c,"throw",t)}r(void 0)}))}}function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(Object(a),!0).forEach((function(e){l(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var h=function(){a.e("components/uni-ui/uni-collapse/uni-collapse").then(function(){return resolve(a("6763"))}.bind(null,a)).catch(a.oe)},d=function(){a.e("components/uni-ui/uni-collapse-item/uni-collapse-item").then(function(){return resolve(a("7c54"))}.bind(null,a)).catch(a.oe)},p=function(){Promise.all([a.e("common/vendor"),a.e("components/k-ui/k-team/k-user")]).then(function(){return resolve(a("bf00"))}.bind(null,a)).catch(a.oe)},f=function(){a.e("components/k-ui/k-user-list/k-list").then(function(){return resolve(a("1c26"))}.bind(null,a)).catch(a.oe)},m=function(){a.e("components/uni-ui/uni-number-box/uni-number-box").then(function(){return resolve(a("551e"))}.bind(null,a)).catch(a.oe)},g=function(){a.e("components/uni-ui/uni-link/uni-link").then(function(){return resolve(a("f43f"))}.bind(null,a)).catch(a.oe)},w=function(){a.e("components/min-action-sheet/min-action-sheet").then(function(){return resolve(a("c0dd"))}.bind(null,a)).catch(a.oe)},v={props:{},components:{uniCollapse:h,uniCollapseItem:d,kList:p,kPoster:f,uniNumberBox:m,uniLink:g,minActionSheet:w},computed:u({},(0,i.mapState)(["hasLogin","userInfo"]),{countApplicant:function(){return""==this.datas?0:this.datas.team.applicant.length},countMembers:function(){return""==this.datas?0:this.datas.team.members.length},needNum:function(){return""==this.datas?0:this.datas.team.size-this.datas.team.members.length<0?0:this.datas.team.size-this.datas.team.members.length},showContact:function(){return""!=this.user&&""!=this.datas&&(console.log(this.user.id),console.log(this.datas.leader.id),console.log(this.datas.team.isMember),console.log(this.datas.team.isApplicant),!(this.user.id!=this.datas.leader.id&&!this.datas.team.isMember&&!this.datas.team.isApplicant)||1==this.datas.leader.id)}}),mounted:function(){this.user=this.$store.getters.getUserInfo},data:function(){return{modalShow:"",teamName:"",contact:"",teamBrief:"",need:"",curTeamId:"",datas:[],game:[],leader:[],placeholder:"",user:"",applyModalShow:!1,applyModalInput:"",applyClearIconShow:!1,actions1:[{name:"同意入队",icon:"cuIcon-roundcheckfill",color:"#19be6b"},{name:"拒绝入队",icon:"cuIcon-roundclosefill",color:"#fa3534"},{name:"查看信息",icon:"cuIcon-search",color:"#007aff"}],actions2:[{name:"移出队伍",icon:"cuIcon-roundclosefill",color:"#fa3534"},{name:"查看信息",icon:"cuIcon-search",color:"#007aff"}]}},onLoad:function(e){t.showLoading({title:"正在加载"}),this.curTeamId=e.id,this.loadData()},onPullDownRefresh:function(){t.showLoading({title:"正在加载"}),this.loadData()},methods:{applicantOp:function(t){var e=this,a=this.actions1;this.leader[0].id!=this.user.id&&(a=[],a.push(this.actions1[2])),this.$refs.as.handleShow({actions:a,success:function(n){if(1!=a.length)switch(n.id){case-1:console.log(n);break;case 0:e.agree(t);break;case 1:e.disagree(t);break;case 2:e.userDetail(t);break}else e.userDetail(t)}})},memberOp:function(t){var e=this,a=this.actions2;this.leader[0].id!=this.user.id&&(a=[],a.push(this.actions2[1])),this.$refs.as.handleShow({actions:a,success:function(n){if(1!=a.length)switch(n.id){case-1:console.log(n);break;case 0:e.kickOut(t);break;case 1:e.userDetail(t);break}else e.userDetail(t)}})},isBoundWx:function(){var e=r(n.default.mark((function e(a){var i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.request({url:"/isBoundWx/"+a});case 2:i=e.sent,0==i.data.isBoundWeChat&&t.showModal({title:"提示",content:"检测到该用户未关注‘i瓜大’公众号，将无法及时接收您的组队请求，建议自行联系~",showCancel:!1,confirmText:"知道了",confirmColor:"#8c8b83",success:function(t){}});case 4:case"end":return e.stop()}}),e,this)})));function a(t){return e.apply(this,arguments)}return a}(),applyShowModal:function(){1!=this.leader[0].id?this.check()&&(this.applyModalShow=!0):t.showModal({title:"提示",content:"官方转发信息，请自行联系~",showCancel:!1,confirmText:"知道了",confirmColor:"#8c8b83",success:function(t){}})},applyModalConfim:function(){""!=this.applyModalInput?(this.apply(this.datas.team.id),this.applyHideModal()):this.$api.msg("请完善信息~")},applyClearIcon:function(){this.applyModalInput=""},applyModalInputing:function(){this.applyModalInput.length>0?this.applyClearIconShow=!0:this.applyClearIconShow=!1},applyHideModal:function(){this.applyModalShow=!1,this.applyModalInput=""},needChange:function(t){this.need=t,t==this.game.teamSize&&this.$api.msg("不大于队伍最大人数~"),""!=this.datas&&t==this.datas.team.members.length&&this.$api.msg("不小于队伍中的人数~")},complete:function(e){t.showModal({title:"提示",content:e,showCancel:!0,confirmText:"去设置",success:function(e){e.confirm&&t.navigateTo({url:"/pages/set/personInfo/personInfo"})}})},check:function(){return""!=this.user.contact||(this.complete("请完善您的联系方式~"),!1)},unApply:function(e){var a=this;t.showModal({title:"取消提示",content:"两分钟内无法再次申请，您确定取消申请吗？",showCancel:!0,confirmText:"确定",success:function(){var i=r(n.default.mark((function i(s){var o;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!s.confirm){n.next=7;break}return t.showLoading({title:"正在取消..."}),n.next=4,a.$api.request({url:"/team/unApply/"+e});case 4:o=n.sent,t.hideLoading(),200==o.status?(a.loadData(),t.showToast({title:"取消成功~"}),setTimeout((function(){a.$api.prePage().loadData&&a.$api.prePage().loadData()}),1e3)):o.status.startsWith("1000")?a.$api.msg(o.msg):a.$api.msg("系统正忙~");case 7:case"end":return n.stop()}}),i)})));function s(t){return i.apply(this,arguments)}return s}()})},apply:function(){var e=r(n.default.mark((function e(a){var i,s=this;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.request({url:"/team/apply/"+a,method:"POST",data:{remark:this.applyModalInput}});case 2:i=e.sent,200==i.status?(this.loadData(),t.showToast({title:"申请成功~"}),setTimeout((function(){s.$api.prePage().loadData&&s.$api.prePage().loadData(),console.log("----------------"),console.log(s.datas),console.log(s.datas.leader.id),s.isBoundWx(s.datas.leader.id)}),1e3)):i.status.startsWith("1000")?this.$api.msg(i.msg):this.$api.msg("系统正忙~");case 4:case"end":return e.stop()}}),e,this)})));function a(t){return e.apply(this,arguments)}return a}(),quit:function(e){var a=this;t.showModal({title:"退出提示",content:"2分钟内无法再次申请，您确定退出队伍吗？",showCancel:!0,confirmText:"确定",success:function(){var i=r(n.default.mark((function i(s){var o;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!s.confirm){n.next=7;break}return t.showLoading({title:"正在退出..."}),n.next=4,a.$api.request({url:"/team/unApply/"+e});case 4:o=n.sent,t.hideLoading(),200==o.status?(a.loadData(),t.showToast({title:"退出成功~"}),setTimeout((function(){a.$api.prePage().loadData&&a.$api.prePage().loadData()}),1e3)):o.status.startsWith("1000")?a.$api.msg(o.msg):a.$api.msg("系统正忙~");case 7:case"end":return n.stop()}}),i)})));function s(t){return i.apply(this,arguments)}return s}()})},showModal:function(t){this.teamName=this.datas.team.name,this.contact=this.datas.team.contact,this.teamBrief=this.datas.team.brief,this.need=this.datas.team.size,this.modalShow=!0},hideModal:function(t){this.modalShow=!1},confirmModal:function(){""!=this.teamName&&""!=this.teamBrief&&""!=this.contact?(this.update(),this.hideModal()):this.$api.msg("请完善信息~")},update:function(){var t=r(n.default.mark((function t(e){var a;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$api.request({url:"/team/update",data:{teamId:this.curTeamId,name:this.teamName,contact:this.contact,size:this.need,brief:this.teamBrief}});case 2:a=t.sent,this.showTip(a.status,a.msg);case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),userDetail:function(e){t.navigateTo({url:"/pages/person/person-detail?id="+e})},finish:function(){var e=this;t.showModal({title:"完成组队",content:"您已组队成功了吗？",showCancel:!0,confirmText:"是的",success:function(t){t.confirm&&e.finishTeam()}})},finishTeam:function(){var e=r(n.default.mark((function e(a){var i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading(),e.next=3,this.$api.request({url:"/team/update",data:{teamId:this.curTeamId,size:0}});case 3:i=e.sent,console.log(i),t.hideLoading(),200==i.status?(t.navigateBack(),this.$api.prePage().loadData&&this.$api.prePage().loadData(),this.$api.msg("恭喜您组队成功~")):i.status.startsWith("1000")?this.$api.msg(i.msg):this.$api.msg("服务器正忙~");case 7:case"end":return e.stop()}}),e,this)})));function a(t){return e.apply(this,arguments)}return a}(),dissolve:function(){var e=this;t.showModal({title:"解散队伍",content:"您确定解散队伍吗？",showCancel:!0,confirmText:"解散",success:function(t){t.confirm&&e.dissolveTeam()}})},dissolveTeam:function(){var e=r(n.default.mark((function e(a){var i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading(),e.next=3,this.$api.request({url:"/team/dissolve/"+this.curTeamId});case 3:i=e.sent,console.log(i),t.hideLoading(),200==i.status?(t.navigateBack(),this.$api.prePage().loadData&&this.$api.prePage().loadData(),t.showToast({title:"队伍已解散~"})):i.status.startsWith("1000")?this.$api.msg(i.msg):this.$api.msg("服务器正忙~");case 7:case"end":return e.stop()}}),e,this)})));function a(t){return e.apply(this,arguments)}return a}(),loadData:function(){var e=r(n.default.mark((function e(){var a;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.request({url:"/team/teamDetail/"+this.curTeamId});case 2:a=e.sent,console.log(a),this.datas=a.data,this.game=a.data.game,this.leader[0]=a.data.leader,t.stopPullDownRefresh(),t.hideLoading();case 9:case"end":return e.stop()}}),e,this)})));function a(){return e.apply(this,arguments)}return a}(),showTip:function(e,a){console.log(e),console.log(a),e.startsWith("1000")?this.$api.msg(a):"200"==e?(this.loadData(),t.showToast({title:"操作成功~"})):this.$api.msg("系统正忙~")},kickOut:function(){var e=r(n.default.mark((function e(a){var i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(this.curTeamId),console.log(a),t.showLoading(),e.next=5,this.$api.request({url:"/team/deleteApply",data:{teamId:this.curTeamId,applyId:a}});case 5:i=e.sent,this.showTip(i.status,i.msg);case 7:case"end":return e.stop()}}),e,this)})));function a(t){return e.apply(this,arguments)}return a}(),agree:function(){var e=r(n.default.mark((function e(a){var i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading(),e.next=3,this.$api.request({url:"/team/agree",data:{teamId:this.curTeamId,applyId:a}});case 3:i=e.sent,this.showTip(i.status,i.msg);case 5:case"end":return e.stop()}}),e,this)})));function a(t){return e.apply(this,arguments)}return a}(),disagree:function(){var e=r(n.default.mark((function e(a){var i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading(),e.next=3,this.$api.request({url:"/team/disagree",data:{teamId:this.curTeamId,applyId:a}});case 3:i=e.sent,this.showTip(i.status,i.msg);case 5:case"end":return e.stop()}}),e,this)})));function a(t){return e.apply(this,arguments)}return a}(),goGameDetail:function(e){t.navigateTo({url:"/pages/game/game-detail?id="+e})}},onShareAppMessage:function(){return{title:"快来加入我的队伍吧~",path:"/pages/user/team/my-team-detail?id="+this.curTeamId}}};e.default=v}).call(this,a("543d")["default"])},8598:function(t,e,a){"use strict";var n={"min-action-sheet":function(){return a.e("components/min-action-sheet/min-action-sheet").then(a.bind(null,"c0dd"))}},i=function(){var t=this,e=t.$createElement;t._self._c},s=[];a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return n}))},9655:function(t,e,a){"use strict";(function(t){a("1a2d"),a("921b");n(a("66fd"));var e=n(a("967c"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"967c":function(t,e,a){"use strict";a.r(e);var n=a("8598"),i=a("5190");for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("e01c");var o,r=a("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);e["default"]=c.exports},cb30:function(t,e,a){},e01c:function(t,e,a){"use strict";var n=a("cb30"),i=a.n(n);i.a}},[["9655","common/runtime","common/vendor"]]]);